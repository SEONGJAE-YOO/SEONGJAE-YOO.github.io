<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Bag of Words Meets Bags of Popcorn ìºê¸€</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- ì›¹í°íŠ¸ ì¶”ê°€ -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- syntax.css ì¶”ê°€ -->
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />



    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="SeongJae Yu ë¸”ë¡œê·¸" />
<link rel="shortcut icon" href="https://SEONGJAE-YOO.github.io/assets/built/images/favicon.jpg" type="image/png" />
<link rel="canonical" href="https://SEONGJAE-YOO.github.io/Bag_of_Words_Meets_Bags_of_Popcorn" />
<meta name="referrer" content="no-referrer-when-downgrade" />

 <!--title below is coming from _includes/dynamic_title-->
<meta property="og:site_name" content="Big Data" />
<meta property="og:type" content="website" />
<meta property="og:title" content="Bag of Words Meets Bags of Popcorn ìºê¸€" />
<meta property="og:description" content="SeongJae Yu ë¸”ë¡œê·¸" />
<meta property="og:url" content="https://SEONGJAE-YOO.github.io/Bag_of_Words_Meets_Bags_of_Popcorn" />
<meta property="og:image" content="https://SEONGJAE-YOO.github.io/assets/built/images/logo-python.png" />
<meta property="article:publisher" content="https://www.facebook.com/" />
<meta property="article:tag" content="Kaggle" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Bag of Words Meets Bags of Popcorn ìºê¸€" />
<meta name="twitter:description" content="SeongJae Yu ë¸”ë¡œê·¸" />
<meta name="twitter:url" content="https://SEONGJAE-YOO.github.io/" />
<meta name="twitter:image" content="https://SEONGJAE-YOO.github.io/assets/built/images/logo-python.png" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="Big Data" />
<meta name="twitter:label2" content="Filed under" />
<meta name="twitter:data2" content="Kaggle" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta property="og:image:width" content="2000" />
<meta property="og:image:height" content="666" />

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Website",
        "publisher": {
            "@type": "Organization",
            "name": "Big Data",
            "logo": "https://SEONGJAE-YOO.github.io/"
        },
        "url": "https://SEONGJAE-YOO.github.io/Bag_of_Words_Meets_Bags_of_Popcorn",
        "image": {
            "@type": "ImageObject",
            "url": "https://SEONGJAE-YOO.github.io/assets/built/images/logo-python.png",
            "width": 2000,
            "height": 666
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://SEONGJAE-YOO.github.io/Bag_of_Words_Meets_Bags_of_Popcorn"
        },
        "description": "SeongJae Yu ë¸”ë¡œê·¸"
    }
</script>

<!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
<script type="text/javascript">
ghost.init({
    clientId: "ghost-frontend",
    clientSecret: "f84a07a72b17"
});
</script> -->

<meta name="generator" content="Jekyll 3.6.2" />
<link rel="alternate" type="application/rss+xml" title="Bag of Words Meets Bags of Popcorn ìºê¸€" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- < default -->
<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<!-- The big featured header, it uses blog cover image as a BG if available -->
<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://SEONGJAE-YOO.github.io/">Big Data</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="https://codingstorylove.github.io/about/#page-title">About blog</a></li>
    <li class="nav-rprogramming" role="menuitem"><a href="/tag/rprogramming/">R</a></li>
    <li class="nav-processmining" role="menuitem"><a href="/tag/processmining/">Processmining</a></li>
    <li class="nav-python" role="menuitem"><a href="/tag/python/">Python</a></li>
    <li class="nav-Algorithm" role="menuitem"><a href="https://codingstorylove.github.io/">Algorithm</a></li>
    <li class="nav-kaggle" role="menuitem"><a href="/tag/kaggle">kaggle</a></li>
    <li class="nav-book" role="menuitem"><a href="/tag/book">book</a></li>
    <li class="nav-udemy" role="menuitem"><a href="/tag/udemy">udemy</a></li>
    <li class="nav-thesis" role="menuitem"><a href="/tag/thesis">thesis</a></li>
    <li class="nav-archive" role="menuitem">
        <a href="/archive.html">All Posts</a>
    </li>
    <li class="nav-archive" role="menuitem">
        <a href="/author_archive.html">Tagë³„ Posts</a>
    </li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-kaggle post tag-kaggle ">

            <header class="post-full-header">
                <h1 class="post-full-title">Bag of Words Meets Bags of Popcorn ìºê¸€</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/built/images/logo-python.png)">
            </figure>
            

            <section class="post-full-content">
                <p><span class="table-of-contents-list"></span>
<!--<ul class="table-of-contents-list">--></p>

<!--</ul>-->

<p>Bag of Words Meets Bags of PopcornÂ¶</p>

<p>https://www.kaggle.com/c/word2vec-nlp-tutorial</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">SEONGJAE</span><span class="o">-</span><span class="n">YOO</span><span class="o">/</span><span class="n">Kaggle</span><span class="p">.</span><span class="n">git</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cloning into 'Kaggle'...
remote: Enumerating objects: 3, done.[K
remote: Counting objects: 100% (3/3), done.[K
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0[K
Unpacking objects: 100% (3/3), done.
</code></pre></div></div>

<h1 id="ê°œìš”">ê°œìš”</h1>
<p>NLP(ìì—°ì–´ì²˜ë¦¬)ëŠ” í…ìŠ¤íŠ¸ ë¬¸ì œì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì§‘í•©ì´ë‹¤. ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” IMDB ì˜í™” ë¦¬ë·°ë¥¼ ë¡œë”©í•˜ê³  ì •ì œí•˜ê³  ê°„ë‹¨í•œ BOW(Bag of Words) ëª¨ë¸ì„ ì ìš©í•˜ì—¬ ë¦¬ë·°ê°€ ì¶”ì²œì¸ì§€ ì•„ë‹Œì§€ì— ëŒ€í•œ ì •í™•ë„ë¥¼ ì˜ˆì¸¡í•œë‹¤.</p>

<h1 id="bowbag-of-words">BOW(bag of words)</h1>
<p>ê°€ì¥ ê°„ë‹¨í•˜ì§€ë§Œ íš¨ê³¼ì ì´ë¼ ë„ë¦¬ì“°ì´ëŠ” ë°©ë²•
ì¥, ë¬¸ë‹¨, ë¬¸ì¥, ì„œì‹ê³¼ ê°™ì€ ì…ë ¥ í…ìŠ¤íŠ¸ì˜ êµ¬ì¡°ë¥¼ ì œì™¸í•˜ê³  ê° ë‹¨ì–´ê°€ ì´ ë§ë­‰ì¹˜ì— ì–¼ë§ˆë‚˜ ë§ì´ ë‚˜íƒ€ë‚˜ëŠ”ì§€ë§Œ í—¤ì•„ë¦°ë‹¤.
êµ¬ì¡°ì™€ ìƒê´€ì—†ì´ ë‹¨ì–´ì˜ ì¶œí˜„íšŸìˆ˜ë§Œ ì„¸ê¸° ë•Œë¬¸ì— í…ìŠ¤íŠ¸ë¥¼ ë‹´ëŠ” ê°€ë°©(bag)ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤.
BOWëŠ” ë‹¨ì–´ì˜ ìˆœì„œê°€ ì™„ì „íˆ ë¬´ì‹œ ëœë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì˜ë¯¸ê°€ ì™„ì „íˆ ë°˜ëŒ€ì¸ ë‘ ë¬¸ì¥ì´ ìˆë‹¤ê³  í•˜ë‹¤.
itâ€™s bad, not good at all.
itâ€™s good, not bad at all.
ìœ„ ë‘ ë¬¸ì¥ì€ ì˜ë¯¸ê°€ ì „í˜€ ë°˜ëŒ€ì§€ë§Œ ì™„ì „íˆ ë™ì¼í•˜ê²Œ ë°˜í™˜ëœë‹¤.
ì´ë¥¼ ë³´ì™„í•˜ê¸° ìœ„í•´ n-gramì„ ì‚¬ìš©í•˜ëŠ” ë° BOWëŠ” í•˜ë‚˜ì˜ í† í°ì„ ì‚¬ìš©í•˜ì§€ë§Œ n-gramì€ nê°œì˜ í† í°ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.</p>

<p>Bag-of-words model - Wikipedia</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>

<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive/'</span><span class="p">)</span>

 
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Drive already mounted at /content/drive/; to attempt to forcibly remount, call drive.mount("/content/drive/", force_remount=True).
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="s">"""
header = 0 ì€ íŒŒì¼ì˜ ì²« ë²ˆì§¸ ì¤„ì— ì—´ ì´ë¦„ì´ ìˆìŒì„ ë‚˜íƒ€ë‚´ë©° 
delimiter = </span><span class="se">\t</span><span class="s"> ëŠ” í•„ë“œê°€ íƒ­ìœ¼ë¡œ êµ¬ë¶„ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
quoting = 3ì€ ìŒë”°ì˜´í‘œë¥¼ ë¬´ì‹œí•˜ë„ë¡ í•œë‹¤.
"""</span>
<span class="c1"># QUOTE_MINIMAL (0), QUOTE_ALL (1), 
# QUOTE_NONNUMERIC (2) or QUOTE_NONE (3).
</span>
<span class="c1"># ë ˆì´ë¸”ì¸ sentiment ê°€ ìˆëŠ” í•™ìŠµ ë°ì´í„°
</span><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/kaggle/data/labeledTrainData.tsv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># ë ˆì´ë¸”ì´ ì—†ëŠ” í…ŒìŠ¤íŠ¸ ë°ì´í„°
</span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/kaggle/data/testData.tsv'</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">'</span><span class="se">\t</span><span class="s">'</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">train</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(25000, 3)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sentiment</th>
      <th>review</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24997</th>
      <td>"10905_3"</td>
      <td>0</td>
      <td>"Guy is a loser. Can't get girls, needs to bui...</td>
    </tr>
    <tr>
      <th>24998</th>
      <td>"10194_3"</td>
      <td>0</td>
      <td>"This 30 minute documentary BuÃ±uel made in the...</td>
    </tr>
    <tr>
      <th>24999</th>
      <td>"8478_8"</td>
      <td>1</td>
      <td>"I saw this movie as a child and it broke my h...</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(25000, 2)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>review</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"12311_10"</td>
      <td>"Naturally in a film who's main themes are of ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"8348_2"</td>
      <td>"This movie is a disaster within a disaster fi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"5828_4"</td>
      <td>"All in all, this is a movie for kids. We saw ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"7186_2"</td>
      <td>"Afraid of the Dark left me with the impressio...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"12128_7"</td>
      <td>"A very accurate depiction of small time mob l...</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['id', 'sentiment', 'review'], dtype=object)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array(['id', 'review'], dtype=object)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 25000 entries, 0 to 24999
Data columns (total 3 columns):
 #   Column     Non-Null Count  Dtype 
---  ------     --------------  ----- 
 0   id         25000 non-null  object
 1   sentiment  25000 non-null  int64 
 2   review     25000 non-null  object
dtypes: int64(1), object(2)
memory usage: 586.1+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>25000.00000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.50000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.50001</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.50000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.00000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.00000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'sentiment'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1    12500
0    12500
Name: sentiment, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">][</span><span class="mi">0</span><span class="p">][:</span><span class="mi">700</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'"With all this stuff going down at the moment with MJ i\'ve started listening to his music, watching the odd documentary here and there, watched The Wiz and watched Moonwalker again. Maybe i just want to get a certain insight into this guy who i thought was really cool in the eighties just to maybe make up my mind whether he is guilty or innocent. Moonwalker is part biography, part feature film which i remember going to see at the cinema when it was originally released. Some of it has subtle messages about MJ\'s feeling towards the press and also the obvious message of drugs are bad m\'kay.&lt;br /&gt;&lt;br /&gt;Visually impressive but of course this is all about Michael Jackson so unless you remotely lik'
</code></pre></div></div>

<h1 id="ë°ì´í„°-ì •ì œ-data-cleaning-and-text-preprocessing">ë°ì´í„° ì •ì œ Data Cleaning and Text Preprocessing</h1>
<p>ê¸°ê³„ê°€ í…ìŠ¤íŠ¸ë¥¼ ì´í•´í•  ìˆ˜ ìˆë„ë¡ í…ìŠ¤íŠ¸ë¥¼ ì •ì œí•´ ì¤€ë‹¤.</p>

<p>ì‹ í˜¸ì™€ ì†ŒìŒì„ êµ¬ë¶„í•œë‹¤. ì•„ì›ƒë¼ì´ì–´ë°ì´í„°ë¡œ ì¸í•œ ì˜¤ë²„í”¼íŒ…ì„ ë°©ì§€í•œë‹¤.</p>

<p>BeautifulSoup(ë·°í‹°í’€ìˆ©)ì„ í†µí•´ HTML íƒœê·¸ë¥¼ ì œê±°
ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ì•ŒíŒŒë²³ ì´ì™¸ì˜ ë¬¸ìë¥¼ ê³µë°±ìœ¼ë¡œ ì¹˜í™˜
NLTK ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ ë¶ˆìš©ì–´(Stopword)ë¥¼ ì œê±°
ì–´ê°„ì¶”ì¶œ(ìŠ¤í…Œë° Stemming)ê³¼ ìŒì†Œí‘œê¸°ë²•(Lemmatizing)ì˜ ê°œë…ì„ ì´í•´í•˜ê³  SnowballStemmerë¥¼ í†µí•´ ì–´ê°„ì„ ì¶”ì¶œ
í…ìŠ¤íŠ¸ ë°ì´í„° ì „ì²˜ë¦¬ ì´í•´í•˜ê¸°
(ì¶œì²˜ : íŠ¸ìœ„í„° í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„ê¸°)</p>

<p>ì •ê·œí™” normalization (ì…ë‹ˆë‹¼ã…‹ã…‹ -&gt; ì…ë‹ˆë‹¤ ã…‹ã…‹, ìƒ¤ë¦‰í•´ -&gt; ì‚¬ë‘í•´)</p>

<p>í•œêµ­ì–´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¼ã…‹ã…‹ã…‹ã…‹ã…‹ -&gt; í•œêµ­ì–´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤ ã…‹ã…‹
í† í°í™” tokenization</p>

<p>í•œêµ­ì–´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤ ã…‹ã…‹ -&gt; í•œêµ­ì–´Noun, ë¥¼Josa, ì²˜ë¦¬Noun, í•˜ëŠ”Verb, ì˜ˆì‹œNoun, ì…Adjective, ë‹ˆë‹¤Eomi ã…‹ã…‹KoreanParticle
ì–´ê·¼í™” stemming (ì…ë‹ˆë‹¤ -&gt; ì´ë‹¤)</p>

<p>í•œêµ­ì–´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤ ã…‹ã…‹ -&gt; í•œêµ­ì–´Noun, ë¥¼Josa, ì²˜ë¦¬Noun, í•˜ë‹¤Verb, ì˜ˆì‹œNoun, ì´ë‹¤Adjective, ã…‹ã…‹KoreanParticle
ì–´êµ¬ ì¶”ì¶œ phrase extraction</p>

<p>í•œêµ­ì–´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤ ã…‹ã…‹ -&gt; í•œêµ­ì–´, ì²˜ë¦¬, ì˜ˆì‹œ, ì²˜ë¦¬í•˜ëŠ” ì˜ˆì‹œ
Introductory Presentation: Google Slides</p>

<p>ë·°í‹°í’€ìˆ©ì´ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ìš°ì„  ì„¤ì¹˜í•´ ì¤€ë‹¤.
!pip install BeautifulSoup4</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">example1</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">"html5lib"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">][</span><span class="mi">0</span><span class="p">][:</span><span class="mi">700</span><span class="p">])</span>
<span class="n">example1</span><span class="p">.</span><span class="n">get_text</span><span class="p">()[:</span><span class="mi">700</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"With all this stuff going down at the moment with MJ i've started listening to his music, watching the odd documentary here and there, watched The Wiz and watched Moonwalker again. Maybe i just want to get a certain insight into this guy who i thought was really cool in the eighties just to maybe make up my mind whether he is guilty or innocent. Moonwalker is part biography, part feature film which i remember going to see at the cinema when it was originally released. Some of it has subtle messages about MJ's feeling towards the press and also the obvious message of drugs are bad m'kay.&lt;br /&gt;&lt;br /&gt;Visually impressive but of course this is all about Michael Jackson so unless you remotely lik





'"With all this stuff going down at the moment with MJ i\'ve started listening to his music, watching the odd documentary here and there, watched The Wiz and watched Moonwalker again. Maybe i just want to get a certain insight into this guy who i thought was really cool in the eighties just to maybe make up my mind whether he is guilty or innocent. Moonwalker is part biography, part feature film which i remember going to see at the cinema when it was originally released. Some of it has subtle messages about MJ\'s feeling towards the press and also the obvious message of drugs are bad m\'kay.Visually impressive but of course this is all about Michael Jackson so unless you remotely like MJ in anyw'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•´ì„œ íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°
</span><span class="kn">import</span> <span class="nn">re</span>
<span class="c1">#ì†Œë¬¸ìì™€ ëŒ€ë¬¸ìê°€ ì•„ë‹Œ ê²ƒì€ ê³µë°±ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤
</span><span class="n">letters_only</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[^a-zA-Z]'</span><span class="p">,</span><span class="s">' '</span><span class="p">,</span><span class="n">example1</span><span class="p">.</span><span class="n">get_text</span><span class="p">())</span>
<span class="n">letters_only</span><span class="p">[:</span><span class="mi">700</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>' With all this stuff going down at the moment with MJ i ve started listening to his music  watching the odd documentary here and there  watched The Wiz and watched Moonwalker again  Maybe i just want to get a certain insight into this guy who i thought was really cool in the eighties just to maybe make up my mind whether he is guilty or innocent  Moonwalker is part biography  part feature film which i remember going to see at the cinema when it was originally released  Some of it has subtle messages about MJ s feeling towards the press and also the obvious message of drugs are bad m kay Visually impressive but of course this is all about Michael Jackson so unless you remotely like MJ in anyw'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ëª¨ë‘ ì†Œë¬¸ìë¡œ ë³€í™˜í•œë‹¤.
</span><span class="n">lower_case</span> <span class="o">=</span> <span class="n">letters_only</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
<span class="c1">#ë¬¸ìë¡œ ë‚˜ëˆˆë‹¤ =&gt; í† í°í™”
</span><span class="n">words</span> <span class="o">=</span> <span class="n">lower_case</span><span class="p">.</span><span class="n">split</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
<span class="n">words</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>437





['with',
 'all',
 'this',
 'stuff',
 'going',
 'down',
 'at',
 'the',
 'moment',
 'with']
</code></pre></div></div>

<ul>
  <li>ë¶ˆìš©ì–´ ì œê±°(Stopword Removal)</li>
</ul>

<p>ì¼ë°˜ì ìœ¼ë¡œ ì½”í¼ìŠ¤ì—ì„œ ìì£¼ ë‚˜íƒ€ë‚˜ëŠ” ë‹¨ì–´ëŠ” í•™ìŠµ ëª¨ë¸ë¡œì„œ í•™ìŠµì´ë‚˜ ì˜ˆì¸¡ í”„ë¡œì„¸ìŠ¤ì— ì‹¤ì œë¡œ ê¸°ì—¬í•˜ì§€ ì•Šì•„ ë‹¤ë¥¸ í…ìŠ¤íŠ¸ì™€ êµ¬ë³„í•˜ì§€ ëª»í•œë‹¤. ì˜ˆë¥¼ë“¤ì–´ ì¡°ì‚¬, ì ‘ë¯¸ì‚¬, i, me, my, it, this, that, is, are ë“± ê³¼ ê°™ì€ ë‹¨ì–´ëŠ” ë¹ˆë²ˆí•˜ê²Œ ë“±ì¥í•˜ì§€ë§Œ ì‹¤ì œ ì˜ë¯¸ë¥¼ ì°¾ëŠ”ë° í° ê¸°ì—¬ë¥¼ í•˜ì§€ ì•ŠëŠ”ë‹¤. StopwordsëŠ” â€œtoâ€ë˜ëŠ” â€œtheâ€ì™€ ê°™ì€ ìš©ì–´ë¥¼ í¬í•¨í•˜ë¯€ë¡œ ì‚¬ì „ ì²˜ë¦¬ ë‹¨ê³„ì—ì„œ ì œê±°í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. NLTKì—ëŠ” 153 ê°œì˜ ì˜ì–´ ë¶ˆìš©ì–´ê°€ ë¯¸ë¦¬ ì •ì˜ë˜ì–´ ìˆë‹¤. 17ê°œì˜ ì–¸ì–´ì— ëŒ€í•´ ì •ì˜ë˜ì–´ ìˆìœ¼ë©° í•œêµ­ì–´ëŠ” ì—†ë‹¤</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í…ìŠ¤íŠ¸ ë°ì´í„° ì „ì²˜ë¦¬ë¥¼ ìœ„í•´ ë‹¤ìŒì„ ë‹¤ìš´ë¡œë“œ í•´ì•¼í•¨
</span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="p">.</span><span class="n">download</span><span class="p">(</span><span class="s">'stopwords'</span><span class="p">)</span>
<span class="n">nltk</span><span class="p">.</span><span class="n">download</span><span class="p">(</span><span class="s">'wordnet'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[nltk_data] Downloading package stopwords to /root/nltk_data...
[nltk_data]   Unzipping corpora/stopwords.zip.
[nltk_data] Downloading package wordnet to /root/nltk_data...
[nltk_data]   Unzipping corpora/wordnet.zip.





True
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stopwords</span><span class="p">.</span><span class="n">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['i', 'me', 'my', 'myself', 'we', 'our', 'ours', 'ourselves', 'you', "you're"]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># stopwords ë¥¼ ì œê±°í•œ í† í°ë“¤ 
</span><span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">.</span><span class="n">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">)]</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
<span class="n">words</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>219





['stuff',
 'going',
 'moment',
 'mj',
 'started',
 'listening',
 'music',
 'watching',
 'odd',
 'documentary']
</code></pre></div></div>

<h1 id="ìŠ¤í…Œë°ì–´ê°„ì¶”ì¶œ-í˜•íƒœì†Œ-ë¶„ì„">ìŠ¤í…Œë°(ì–´ê°„ì¶”ì¶œ, í˜•íƒœì†Œ ë¶„ì„)</h1>
<p>ì¶œì²˜ : ì–´ê°„ ì¶”ì¶œ - ìœ„í‚¤ë°±ê³¼, ìš°ë¦¬ ëª¨ë‘ì˜ ë°±ê³¼ì‚¬ì „</p>

<p>ì–´ê°„ ì¶”ì¶œ(èªå¹¹ æŠ½å‡º, ì˜ì–´: stemming)ì€ ì–´í˜•ì´ ë³€í˜•ëœ ë‹¨ì–´ë¡œë¶€í„° ì ‘ì‚¬ ë“±ì„ ì œê±°í•˜ê³  ê·¸ ë‹¨ì–´ì˜ ì–´ê°„ì„ ë¶„ë¦¬í•´ ë‚´ëŠ” ê²ƒ
â€œmessageâ€, â€œmessagesâ€, â€œmessagingâ€ ê³¼ ê°™ì´ ë³µìˆ˜í˜•, ì§„í–‰í˜• ë“±ì˜ ë¬¸ìë¥¼ ê°™ì€ ì˜ë¯¸ì˜ ë‹¨ì–´ë¡œ ë‹¤ë£° ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.
stemming(í˜•íƒœì†Œ ë¶„ì„): ì—¬ê¸°ì—ì„œëŠ” NLTKì—ì„œ ì œê³µí•˜ëŠ” í˜•íƒœì†Œ ë¶„ì„ê¸°ë¥¼ ì‚¬ìš©í•œë‹¤. í¬í„° í˜•íƒœì†Œ ë¶„ì„ê¸°ëŠ” ë³´ìˆ˜ì ì´ê³  ë­ì»¤ìŠ¤í„° í˜•íƒœì†Œ ë¶„ì„ê¸°ëŠ” ì¢€ ë” ì ê·¹ì ì´ë‹¤. í˜•íƒœì†Œ ë¶„ì„ ê·œì¹™ì˜ ì ê·¹ì„± ë•Œë¬¸ì— ë­ì»¤ìŠ¤í„° í˜•íƒœì†Œ ë¶„ì„ê¸°ëŠ” ë” ë§ì€ ë™ìŒì´ì˜ì–´ í˜•íƒœì†Œë¥¼ ìƒì‚°í•œë‹¤</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í¬í„° ìŠ¤íƒœë¨¸ì˜ ì‚¬ìš© ì˜ˆ
</span><span class="n">stemmer</span> <span class="o">=</span> <span class="n">nltk</span><span class="p">.</span><span class="n">stem</span><span class="p">.</span><span class="n">PorterStemmer</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">'maximum'</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The stemmed form of running is: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">"running"</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The stemmed form of runs is: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">"runs"</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The stemmed form of run is: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">"run"</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>maximum
The stemmed form of running is: run
The stemmed form of runs is: run
The stemmed form of run is: run
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë­ì»¤ìŠ¤í„° ìŠ¤íƒœë¨¸ì˜ ì‚¬ìš© ì˜ˆ
</span><span class="kn">from</span> <span class="nn">nltk.stem.lancaster</span> <span class="kn">import</span> <span class="n">LancasterStemmer</span>
<span class="n">lancaster_stemmer</span> <span class="o">=</span> <span class="n">LancasterStemmer</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">lancaster_stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">'maximum'</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The stemmed form of running is: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">lancaster_stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">"running"</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The stemmed form of runs is: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">lancaster_stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">"runs"</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"The stemmed form of run is: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">lancaster_stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="s">"run"</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>maxim
The stemmed form of running is: run
The stemmed form of runs is: run
The stemmed form of run is: run
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ì²˜ë¦¬ ì „ ë‹¨ì–´
</span><span class="n">words</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['stuff',
 'going',
 'moment',
 'mj',
 'started',
 'listening',
 'music',
 'watching',
 'odd',
 'documentary']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">nltk.stem.snowball</span> <span class="kn">import</span> <span class="n">SnowballStemmer</span>

<span class="n">stemmer</span> <span class="o">=</span> <span class="n">SnowballStemmer</span><span class="p">(</span><span class="s">'english'</span><span class="p">)</span>
<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
<span class="c1"># ì²˜ë¦¬ í›„ ë‹¨ì–´
</span><span class="n">words</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['stuff',
 'go',
 'moment',
 'mj',
 'start',
 'listen',
 'music',
 'watch',
 'odd',
 'documentari']
</code></pre></div></div>

<ul>
  <li>Lemmatization ìŒì†Œí‘œê¸°ë²•</li>
</ul>

<p>ì–¸ì–´í•™ì—ì„œ ìŒì†Œ í‘œê¸°ë²• (ë˜ëŠ” lemmatization)ì€ ë‹¨ì–´ì˜ ë³´ì¡° ì •ë¦¬ ë˜ëŠ” ì‚¬ì „ í˜•ì‹ì— ì˜í•´ ì‹ë³„ë˜ëŠ” ë‹¨ì¼ í•­ëª©ìœ¼ë¡œ ë¶„ì„ ë  ìˆ˜ ìˆë„ë¡ êµ´ì ˆ ëœ í˜•íƒœì˜ ë‹¨ì–´ë¥¼ ê·¸ë£¹í™”í•˜ëŠ” ê³¼ì •ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë™ìŒì´ì˜ì–´ê°€ ë¬¸ë§¥ì— ë”°ë¼ ë‹¤ë¥¸ ì˜ë¯¸ë¥¼ ê°–ëŠ”ë°</p>

<p>1) <em>ë°°</em>ê°€ ë§›ìˆë‹¤.</p>

<p>2) <em>ë°°</em>ë¥¼ íƒ€ëŠ” ê²ƒì´ ì¬ë¯¸ìˆë‹¤.</p>

<p>3) í‰ì†Œë³´ë‹¤ ë‘ <em>ë°°</em>ë¡œ ë§ì´ ë¨¹ì–´ì„œ <em>ë°°</em>ê°€ ì•„í”„ë‹¤.
   ìœ„ì— ìˆëŠ” 3ê°œì˜ ë¬¸ì¥ì— ìˆëŠ” â€œë°°â€ëŠ” ëª¨ë‘ ë‹¤ë¥¸ ì˜ë¯¸ë¥¼ ê°–ëŠ”ë‹¤.
   ë ˆë§ˆíƒ€ì´ì œì´ì…˜ì€ ì´ë•Œ ì•ë’¤ ë¬¸ë§¥ì„ ë³´ê³  ë‹¨ì–´ì˜ ì˜ë¯¸ë¥¼ ì‹ë³„í•˜ëŠ” ê²ƒì´ë‹¤. ì˜ì–´ì—ì„œ meetëŠ” meetingìœ¼ë¡œ ì“°ì˜€ì„ ë•Œ íšŒì˜ë¥¼ ëœ»í•˜ì§€ë§Œ meet ì¼ ë•ŒëŠ” ë§Œë‚˜ë‹¤ëŠ” ëœ»ì„ ê°–ëŠ”ë° ê·¸ ë‹¨ì–´ê°€ ëª…ì‚¬ë¡œ ì“°ì˜€ëŠ”ì§€ ë™ì‚¬ë¡œ ì“°ì˜€ëŠ”ì§€ì— ë”°ë¼ ì í•©í•œ ì˜ë¯¸ë¥¼ ê°–ë„ë¡ ì¶”ì¶œí•˜ëŠ” ê²ƒì´ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">nltk.stem</span> <span class="kn">import</span> <span class="n">WordNetLemmatizer</span>
<span class="n">wordnet_lemmatizer</span> <span class="o">=</span> <span class="n">WordNetLemmatizer</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">wordnet_lemmatizer</span><span class="p">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s">'fly'</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">wordnet_lemmatizer</span><span class="p">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="s">'flies'</span><span class="p">))</span>

<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">wordnet_lemmatizer</span><span class="p">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
<span class="c1"># ì²˜ë¦¬ í›„ ë‹¨ì–´
</span><span class="n">words</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fly
fly





['stuff',
 'go',
 'moment',
 'mj',
 'start',
 'listen',
 'music',
 'watch',
 'odd',
 'documentari']
</code></pre></div></div>

<h1 id="ë¬¸ìì—´-ì²˜ë¦¬">ë¬¸ìì—´ ì²˜ë¦¬</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">review_to_words</span><span class="p">(</span> <span class="n">raw_review</span> <span class="p">):</span>
    <span class="c1"># 1. HTML ì œê±°
</span>    <span class="n">review_text</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">raw_review</span><span class="p">,</span> <span class="s">'html.parser'</span><span class="p">).</span><span class="n">get_text</span><span class="p">()</span>
    <span class="c1"># 2. ì˜ë¬¸ìê°€ ì•„ë‹Œ ë¬¸ìëŠ” ê³µë°±ìœ¼ë¡œ ë³€í™˜
</span>    <span class="n">letters_only</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[^a-zA-Z]'</span><span class="p">,</span> <span class="s">' '</span><span class="p">,</span> <span class="n">review_text</span><span class="p">)</span>
    <span class="c1"># 3. ì†Œë¬¸ì ë³€í™˜
</span>    <span class="n">words</span> <span class="o">=</span> <span class="n">letters_only</span><span class="p">.</span><span class="n">lower</span><span class="p">().</span><span class="n">split</span><span class="p">()</span>
    <span class="c1"># 4. íŒŒì´ì¬ì—ì„œëŠ” ë¦¬ìŠ¤íŠ¸ë³´ë‹¤ ì„¸íŠ¸ë¡œ ì°¾ëŠ”ê²Œ í›¨ì”¬ ë¹ ë¥´ë‹¤.
</span>    <span class="c1"># stopwords ë¥¼ ì„¸íŠ¸ë¡œ ë³€í™˜í•œë‹¤.
</span>    <span class="n">stops</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="p">.</span><span class="n">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">))</span>
    <span class="c1"># 5. Stopwords ë¶ˆìš©ì–´ ì œê±°
</span>    <span class="n">meaningful_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">stops</span><span class="p">]</span>
    <span class="c1"># 6. ì–´ê°„ì¶”ì¶œ
</span>    <span class="n">stemming_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">stemmer</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">meaningful_words</span><span class="p">]</span>
    <span class="c1"># 7. ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ëœ ë¬¸ìì—´ë¡œ ê²°í•©í•˜ì—¬ ê²°ê³¼ë¥¼ ë°˜í™˜
</span>    <span class="k">return</span><span class="p">(</span> <span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">stemming_words</span><span class="p">)</span> <span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clean_review</span> <span class="o">=</span> <span class="n">review_to_words</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">clean_review</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'stuff go moment mj start listen music watch odd documentari watch wiz watch moonwalk mayb want get certain insight guy thought realli cool eighti mayb make mind whether guilti innoc moonwalk part biographi part featur film rememb go see cinema origin releas subtl messag mj feel toward press also obvious messag drug bad kay visual impress cours michael jackson unless remot like mj anyway go hate find bore may call mj egotist consent make movi mj fan would say made fan true realli nice actual featur film bit final start minut exclud smooth crimin sequenc joe pesci convinc psychopath power drug lord want mj dead bad beyond mj overheard plan nah joe pesci charact rant want peopl know suppli drug etc dunno mayb hate mj music lot cool thing like mj turn car robot whole speed demon sequenc also director must patienc saint came film kiddi bad sequenc usual director hate work one kid let alon whole bunch perform complex danc scene bottom line movi peopl like mj one level anoth think peopl stay away tri give wholesom messag iron mj bestest buddi movi girl michael jackson truli one talent peopl ever grace planet guilti well attent gave subject hmmm well know peopl differ behind close door know fact either extrem nice stupid guy one sickest liar hope latter'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì²« ë²ˆì§¸ ë¦¬ë·°ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì „ì²˜ë¦¬ í•´ì¤¬ë˜ ë‚´ìš©ì„ ì „ì²´ í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤.
# ì „ì²´ ë¦¬ë·° ë°ì´í„° ìˆ˜ ê°€ì ¸ì˜¤ê¸°
</span><span class="n">num_reviews</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">].</span><span class="n">size</span>
<span class="n">num_reviews</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>25000
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clean_train_reviews</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_reviews</span><span class="p">):</span>
    <span class="n">clean_train_reviews</span><span class="p">.</span><span class="n">append</span><span class="p">(</span> <span class="n">review_to_words</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>

<span class="n">clean_train_reviews</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_reviews</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">5000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Review {} of {} '</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_reviews</span><span class="p">))</span>
    <span class="n">clean_train_reviews</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">review_to_words</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">][</span><span class="n">i</span><span class="p">]))</span>
    

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Review 5000 of 25000 
Review 10000 of 25000 
Review 15000 of 25000 
Review 20000 of 25000 
Review 25000 of 25000 
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">_apply_df</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">args</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">apply_by_multiprocessing</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># í‚¤ì›Œë“œ í•­ëª© ì¤‘ workers íŒŒë¼ë©”í„°ë¥¼ êº¼ëƒ„
</span>    <span class="n">workers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="s">'workers'</span><span class="p">)</span>
    <span class="c1"># ìœ„ì—ì„œ ê°€ì ¸ì˜¨ workers ìˆ˜ë¡œ í”„ë¡œì„¸ìŠ¤ í’€ì„ ì •ì˜
</span>    <span class="n">pool</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">workers</span><span class="p">)</span>
    <span class="c1"># ì‹¤í–‰í•  í•¨ìˆ˜ì™€ ë°ì´í„°í”„ë ˆì„ì„ ì›Œì»¤ì˜ ìˆ˜ ë§Œí¼ ë‚˜ëˆ  ì‘ì—…
</span>    <span class="n">result</span> <span class="o">=</span> <span class="n">pool</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">_apply_df</span><span class="p">,</span> <span class="p">[(</span><span class="n">d</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">workers</span><span class="p">)])</span>
    <span class="n">pool</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c1"># ì‘ì—… ê²°ê³¼ë¥¼ í•©ì³ì„œ ë°˜í™˜
</span>    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">time</span> <span class="n">clean_train_reviews</span> <span class="o">=</span> <span class="n">apply_by_multiprocessing</span><span class="p">(</span>\
    <span class="n">train</span><span class="p">[</span><span class="s">'review'</span><span class="p">],</span> <span class="n">review_to_words</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 457 ms, sys: 197 ms, total: 654 ms
Wall time: 1min 5s
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">time</span> <span class="n">clean_test_reviews</span> <span class="o">=</span> <span class="n">apply_by_multiprocessing</span><span class="p">(</span>\
    <span class="n">test</span><span class="p">[</span><span class="s">'review'</span><span class="p">],</span> <span class="n">review_to_words</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 422 ms, sys: 199 ms, total: 622 ms
Wall time: 1min 3s
</code></pre></div></div>

<h1 id="ì›Œë“œ-í´ë¼ìš°ë“œ">ì›Œë“œ í´ë¼ìš°ë“œ</h1>
<p>ë‹¨ì–´ì˜ ë¹ˆë„ ìˆ˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆì„ ë•Œ ì´ìš©í•  ìˆ˜ ìˆëŠ” ì‹œê°í™” ë°©ë²•
ë‹¨ìˆœíˆ ë¹ˆë„ ìˆ˜ë¥¼ í‘œí˜„í•˜ê¸° ë³´ë‹¤ëŠ” ìƒê´€ê´€ê³„ë‚˜ ìœ ì‚¬ë„ ë“±ìœ¼ë¡œ ë°°ì¹˜í•˜ëŠ” ê²Œ ë” ì˜ë¯¸ ìˆê¸° ë•Œë¬¸ì— í° ì •ë³´ë¥¼ ì–»ê¸°ëŠ” ì–´ë µë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">wordcloud</span> <span class="kn">import</span> <span class="n">WordCloud</span><span class="p">,</span> <span class="n">STOPWORDS</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1"># %matplotlib inline ì„¤ì •ì„ í•´ì£¼ì–´ì•¼ì§€ë§Œ ë…¸íŠ¸ë¶ ì•ˆì— ê·¸ë˜í”„ê°€ ë””ìŠ¤í”Œë ˆì´ ëœë‹¤.
</span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="k">def</span> <span class="nf">displayWordCloud</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">backgroundcolor</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span> <span class="p">):</span>
    <span class="n">wordcloud</span> <span class="o">=</span> <span class="n">WordCloud</span><span class="p">(</span><span class="n">stopwords</span> <span class="o">=</span> <span class="n">STOPWORDS</span><span class="p">,</span> 
                          <span class="n">background_color</span> <span class="o">=</span> <span class="n">backgroundcolor</span><span class="p">,</span> 
                         <span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="p">).</span><span class="n">generate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span> <span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">"off"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í•™ìŠµ ë°ì´í„°ì˜ ëª¨ë“  ë‹¨ì–´ì— ëŒ€í•œ ì›Œë“œ í´ë¼ìš°ë“œë¥¼ ê·¸ë ¤ë³¸ë‹¤.
</span><span class="o">%</span><span class="n">time</span> <span class="n">displayWordCloud</span><span class="p">(</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">clean_train_reviews</span><span class="p">))</span>

</code></pre></div></div>

<p><img src="../../img/kaggle/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn/output_41_0.png" alt="output_41_0" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 21.4 s, sys: 971 ms, total: 22.4 s
Wall time: 22.4 s
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ëª¨ë“  ë‹¨ì–´ì— ëŒ€í•œ ì›Œë“œ í´ë¼ìš°ë“œë¥¼ ê·¸ë ¤ë³¸ë‹¤
</span><span class="o">%</span><span class="n">time</span> <span class="n">displayWordCloud</span><span class="p">(</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">clean_train_reviews</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="../../img/kaggle/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn/output_42_0.png" alt="output_42_0" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 21.7 s, sys: 691 ms, total: 22.4 s
Wall time: 22.3 s
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë‹¨ì–´ ìˆ˜
</span><span class="n">train</span><span class="p">[</span><span class="s">'num_words'</span><span class="p">]</span> <span class="o">=</span> <span class="n">clean_train_reviews</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">split</span><span class="p">()))</span>
<span class="c1"># ì¤‘ë³µì„ ì œê±°í•œ ë‹¨ì–´ ìˆ˜
</span><span class="n">train</span><span class="p">[</span><span class="s">'num_uniq_words'</span><span class="p">]</span> <span class="o">=</span> <span class="n">clean_train_reviews</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">split</span><span class="p">())))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#AttributeError: 'list' object has no attribute 'apply' í•´ê²°ë°©ì•ˆ
</span><span class="n">count_words_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">split</span><span class="p">())</span>

<span class="n">train</span><span class="p">[</span><span class="s">'num_words'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">count_words_f</span><span class="p">,</span> <span class="n">clean_train_reviews</span><span class="p">))</span>

<span class="n">count_uniq_words_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">split</span><span class="p">()))</span>

<span class="n">train</span><span class="p">[</span><span class="s">'num_uniq_words'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">count_uniq_words_f</span><span class="p">,</span> <span class="n">clean_train_reviews</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 25000 entries, 0 to 24999
Data columns (total 5 columns):
 #   Column          Non-Null Count  Dtype 
---  ------          --------------  ----- 
 0   id              25000 non-null  object
 1   sentiment       25000 non-null  int64 
 2   review          25000 non-null  object
 3   num_words       25000 non-null  int64 
 4   num_uniq_words  25000 non-null  int64 
dtypes: int64(3), object(2)
memory usage: 976.7+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì²« ë²ˆì§¸ ë¦¬ë·°ì— 
</span><span class="n">x</span> <span class="o">=</span> <span class="n">clean_train_reviews</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="n">split</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">x</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>219





['stuff',
 'go',
 'moment',
 'mj',
 'start',
 'listen',
 'music',
 'watch',
 'odd',
 'documentari']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="n">plt</span><span class="p">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'font'</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">'Malgun Gothic'</span><span class="p">)</span> <span class="c1">#ê¸€ì ê¹¨ì§ ë°©ì§€
</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'ë¦¬ë·°ë³„ ë‹¨ì–´ í‰ê·  ê°’:'</span><span class="p">,</span><span class="n">train</span><span class="p">[</span><span class="s">'num_words'</span><span class="p">].</span><span class="n">mean</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">'ë¦¬ë·°ë³„ ë‹¨ì–´ ì¤‘ê°„ ê°’:'</span><span class="p">,</span> <span class="n">train</span><span class="p">[</span><span class="s">'num_words'</span><span class="p">].</span><span class="n">mean</span><span class="p">())</span>
<span class="n">sns</span><span class="p">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'num_words'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">axvline</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'num_words'</span><span class="p">].</span><span class="n">median</span><span class="p">(),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'dashed'</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'ë¦¬ë·°ë³„ ë‹¨ì–´ ìˆ˜ ë¶„í¬'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'ë¦¬ë·°ë³„ ê³ ìœ  ë‹¨ì–´ í‰ê·  ê°’:'</span><span class="p">,</span><span class="n">train</span><span class="p">[</span><span class="s">'num_uniq_words'</span><span class="p">].</span><span class="n">mean</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">'ë¦¬ë·°ë³„ ê³ ìœ  ë‹¨ì–´ ì¤‘ê°„ ê°’:'</span><span class="p">,</span><span class="n">train</span><span class="p">[</span><span class="s">'num_uniq_words'</span><span class="p">].</span><span class="n">median</span><span class="p">())</span>
<span class="n">sns</span><span class="p">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'num_uniq_words'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">axvline</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'num_uniq_words'</span><span class="p">].</span><span class="n">median</span><span class="p">(),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'dashed'</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'ë¦¬ë·°ë³„ ê³ ìœ í•œ ë‹¨ì–´ ìˆ˜ ë¶„í¬'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ë¦¬ë·°ë³„ ë‹¨ì–´ í‰ê·  ê°’: 119.52356
ë¦¬ë·°ë³„ ë‹¨ì–´ ì¤‘ê°„ ê°’: 119.52356
ë¦¬ë·°ë³„ ê³ ìœ  ë‹¨ì–´ í‰ê·  ê°’: 94.05756
ë¦¬ë·°ë³„ ê³ ìœ  ë‹¨ì–´ ì¤‘ê°„ ê°’: 74.0





Text(0.5, 1.0, 'ë¦¬ë·°ë³„ ê³ ìœ í•œ ë‹¨ì–´ ìˆ˜ ë¶„í¬')



findfont: Font family ['Malgun Gothic'] not found. Falling back to DejaVu Sans.
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 47532 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 48624 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 48324 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 45800 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50612 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 49688 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 48516 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 54252 missing from current font.
  font.set_text(s, 0.0, flags=flags)
findfont: Font family ['Malgun Gothic'] not found. Falling back to DejaVu Sans.
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 47532 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 48624 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 48324 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 45800 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50612 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 49688 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 48516 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 54252 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44256 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50976 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 54620 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44256 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50976 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.7/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 54620 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre></div></div>

<p><img src="../../img/kaggle/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn/output_47_3.png" alt="output_47_3" /></p>

<h1 id="ì‚¬ì´í‚·ëŸ°ì˜-countvectorizerë¥¼-í†µí•´-í”¼ì²˜-ìƒì„±">ì‚¬ì´í‚·ëŸ°ì˜ CountVectorizerë¥¼ í†µí•´ í”¼ì²˜ ìƒì„±</h1>

<p>ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•´ í† í°ì„ ì¶”ì¶œí•œë‹¤.</p>

<p>ëª¨ë‘ ì†Œë¬¸ìë¡œ ë³€í™˜ì‹œí‚¤ê¸° ë•Œë¬¸ì— good, Good, gOodì´ ëª¨ë‘ ê°™ì€ íŠ¹ì„±ì´ ëœë‹¤.</p>

<p>ì˜ë¯¸ì—†ëŠ” íŠ¹ì„±ì„ ë§ì´ ìƒì„±í•˜ê¸° ë•Œë¬¸ì— ì ì–´ë„ ë‘ ê°œì˜ ë¬¸ì„œì— ë‚˜íƒ€ë‚œ í† í°ë§Œì„ ì‚¬ìš©í•œë‹¤.</p>

<p>min_dfë¡œ í† í°ì´ ë‚˜íƒ€ë‚  ìµœì†Œ ë¬¸ì„œ ê°œìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="c1"># íŠœí† ë¦¬ì–¼ê³¼ ë‹¤ë¥´ê²Œ íŒŒë¼ë©”í„° ê°’ì„ ìˆ˜ì •
# íŒŒë¼ë©”í„° ê°’ë§Œ ìˆ˜ì •í•´ë„ ìºê¸€ ìŠ¤ì½”ì–´ ì°¨ì´ê°€ ë§ì´ ë‚¨
</span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">analyzer</span> <span class="o">=</span> <span class="s">'word'</span><span class="p">,</span> 
                             <span class="n">tokenizer</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
                             <span class="n">preprocessor</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                             <span class="n">stop_words</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                             <span class="n">min_df</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># í† í°ì´ ë‚˜íƒ€ë‚  ìµœì†Œ ë¬¸ì„œ ê°œìˆ˜
</span>                             <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                             <span class="n">max_features</span> <span class="o">=</span> <span class="mi">20000</span>
                            <span class="p">)</span>
<span class="n">vectorizer</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CountVectorizer(analyzer='word', binary=False, decode_error='strict',
                dtype=&lt;class 'numpy.int64'&gt;, encoding='utf-8', input='content',
                lowercase=True, max_df=1.0, max_features=20000, min_df=2,
                ngram_range=(1, 3), preprocessor=None, stop_words=None,
                strip_accents=None, token_pattern='(?u)\\b\\w\\w+\\b',
                tokenizer=None, vocabulary=None)
</code></pre></div></div>

<ul>
  <li>sklearn.pipeline.Pipeline
    <ol>
      <li>workfolwë¥¼ ìë™í™” ì‹œí‚¬ ìˆ˜ ìˆë‹¤</li>
      <li>data leakage ë¬¸ì œë¥¼ ìµœì†Œí™” ì‹œí‚¬ ìˆ˜ ìˆë‹¤</li>
      <li>ì„ í˜•ì  ìˆœì„œë¡œ ë°ì´í„°ë¥¼ transformí•˜ê³  ëª¨ë¸ íŠ¸ë ˆì´ë‹ ë° í‰ê°€ ê¹Œì§€ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ê°€ëŠ¥í•˜ë‹¤.</li>
    </ol>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì—¬ê¸°ì—ì„œëŠ” í•˜ë‚˜ì˜ ê³¼ì •ë§Œ ë¬¶ì–´ì£¼ì–´ pipelineì´ ë¶ˆí•„ìš” í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
# pipelineì€ feature engineeringì˜ ì—¬ëŸ¬ ê³¼ì •ì„ ë¬¶ì–´ ì¤„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
</span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'vect'</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">),</span>
<span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">time</span> <span class="n">train_data_features</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">clean_train_reviews</span><span class="p">)</span>
<span class="n">train_data_features</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 30.5 s, sys: 740 ms, total: 31.3 s
Wall time: 31.2 s





&lt;25000x20000 sparse matrix of type '&lt;class 'numpy.int64'&gt;'
	with 2762268 stored elements in Compressed Sparse Row format&gt;
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data_features</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(25000, 20000)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vocab</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="p">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">))</span>
<span class="n">vocab</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>20000





['aag',
 'aaron',
 'ab',
 'abandon',
 'abbey',
 'abbi',
 'abbot',
 'abbott',
 'abc',
 'abduct']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#ë²¡í„°í™” ëœ í”¼ì²˜ë¥¼ í™•ì¸í•´ ë´„
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">train_data_features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span><span class="n">dist</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">count</span><span class="p">,</span><span class="n">tag</span><span class="p">)</span>
    
<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">vocab</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[[26 48 22 ... 59 40 23]] aag
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aag</th>
      <th>aaron</th>
      <th>ab</th>
      <th>abandon</th>
      <th>abbey</th>
      <th>abbi</th>
      <th>abbot</th>
      <th>abbott</th>
      <th>abc</th>
      <th>abduct</th>
      <th>abe</th>
      <th>abhay</th>
      <th>abid</th>
      <th>abigail</th>
      <th>abil</th>
      <th>abil make</th>
      <th>abl</th>
      <th>abl get</th>
      <th>abl make</th>
      <th>abl see</th>
      <th>abl watch</th>
      <th>abli</th>
      <th>aboard</th>
      <th>abomin</th>
      <th>aborigin</th>
      <th>abort</th>
      <th>abound</th>
      <th>abraham</th>
      <th>abraham lincoln</th>
      <th>abroad</th>
      <th>abrupt</th>
      <th>absenc</th>
      <th>absent</th>
      <th>absolut</th>
      <th>absolut aw</th>
      <th>absolut brilliant</th>
      <th>absolut hilari</th>
      <th>absolut horribl</th>
      <th>absolut love</th>
      <th>absolut noth</th>
      <th>...</th>
      <th>yuen</th>
      <th>yugoslavia</th>
      <th>yup</th>
      <th>yuppi</th>
      <th>yuzna</th>
      <th>yvonn</th>
      <th>zabriski</th>
      <th>zabriski point</th>
      <th>zach</th>
      <th>zack</th>
      <th>zane</th>
      <th>zani</th>
      <th>zatoichi</th>
      <th>zealand</th>
      <th>zelah</th>
      <th>zelah clark</th>
      <th>zelda</th>
      <th>zenia</th>
      <th>zero</th>
      <th>zero day</th>
      <th>zero star</th>
      <th>zeta</th>
      <th>zeta jone</th>
      <th>zhang</th>
      <th>zip</th>
      <th>zizek</th>
      <th>zodiac</th>
      <th>zodiac killer</th>
      <th>zoe</th>
      <th>zombi</th>
      <th>zombi bloodbath</th>
      <th>zombi film</th>
      <th>zombi flick</th>
      <th>zombi movi</th>
      <th>zone</th>
      <th>zoo</th>
      <th>zoom</th>
      <th>zorro</th>
      <th>zu</th>
      <th>zucker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26</td>
      <td>48</td>
      <td>22</td>
      <td>288</td>
      <td>24</td>
      <td>30</td>
      <td>29</td>
      <td>30</td>
      <td>125</td>
      <td>55</td>
      <td>24</td>
      <td>28</td>
      <td>28</td>
      <td>26</td>
      <td>562</td>
      <td>25</td>
      <td>1259</td>
      <td>53</td>
      <td>32</td>
      <td>54</td>
      <td>35</td>
      <td>27</td>
      <td>37</td>
      <td>83</td>
      <td>69</td>
      <td>92</td>
      <td>63</td>
      <td>93</td>
      <td>29</td>
      <td>38</td>
      <td>136</td>
      <td>118</td>
      <td>83</td>
      <td>1850</td>
      <td>29</td>
      <td>35</td>
      <td>42</td>
      <td>23</td>
      <td>93</td>
      <td>154</td>
      <td>...</td>
      <td>21</td>
      <td>28</td>
      <td>26</td>
      <td>32</td>
      <td>25</td>
      <td>25</td>
      <td>40</td>
      <td>36</td>
      <td>22</td>
      <td>21</td>
      <td>70</td>
      <td>38</td>
      <td>33</td>
      <td>47</td>
      <td>43</td>
      <td>34</td>
      <td>28</td>
      <td>31</td>
      <td>390</td>
      <td>44</td>
      <td>32</td>
      <td>38</td>
      <td>37</td>
      <td>37</td>
      <td>23</td>
      <td>85</td>
      <td>45</td>
      <td>26</td>
      <td>27</td>
      <td>1331</td>
      <td>23</td>
      <td>52</td>
      <td>37</td>
      <td>89</td>
      <td>161</td>
      <td>31</td>
      <td>71</td>
      <td>59</td>
      <td>40</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
<p>1 rows Ã— 20000 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">train_data_features</span><span class="p">[:</span><span class="mi">10</span><span class="p">].</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">vocab</span><span class="p">).</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aag</th>
      <th>aaron</th>
      <th>ab</th>
      <th>abandon</th>
      <th>abbey</th>
      <th>abbi</th>
      <th>abbot</th>
      <th>abbott</th>
      <th>abc</th>
      <th>abduct</th>
      <th>abe</th>
      <th>abhay</th>
      <th>abid</th>
      <th>abigail</th>
      <th>abil</th>
      <th>abil make</th>
      <th>abl</th>
      <th>abl get</th>
      <th>abl make</th>
      <th>abl see</th>
      <th>abl watch</th>
      <th>abli</th>
      <th>aboard</th>
      <th>abomin</th>
      <th>aborigin</th>
      <th>abort</th>
      <th>abound</th>
      <th>abraham</th>
      <th>abraham lincoln</th>
      <th>abroad</th>
      <th>abrupt</th>
      <th>absenc</th>
      <th>absent</th>
      <th>absolut</th>
      <th>absolut aw</th>
      <th>absolut brilliant</th>
      <th>absolut hilari</th>
      <th>absolut horribl</th>
      <th>absolut love</th>
      <th>absolut noth</th>
      <th>...</th>
      <th>yuen</th>
      <th>yugoslavia</th>
      <th>yup</th>
      <th>yuppi</th>
      <th>yuzna</th>
      <th>yvonn</th>
      <th>zabriski</th>
      <th>zabriski point</th>
      <th>zach</th>
      <th>zack</th>
      <th>zane</th>
      <th>zani</th>
      <th>zatoichi</th>
      <th>zealand</th>
      <th>zelah</th>
      <th>zelah clark</th>
      <th>zelda</th>
      <th>zenia</th>
      <th>zero</th>
      <th>zero day</th>
      <th>zero star</th>
      <th>zeta</th>
      <th>zeta jone</th>
      <th>zhang</th>
      <th>zip</th>
      <th>zizek</th>
      <th>zodiac</th>
      <th>zodiac killer</th>
      <th>zoe</th>
      <th>zombi</th>
      <th>zombi bloodbath</th>
      <th>zombi film</th>
      <th>zombi flick</th>
      <th>zombi movi</th>
      <th>zone</th>
      <th>zoo</th>
      <th>zoom</th>
      <th>zorro</th>
      <th>zu</th>
      <th>zucker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 20000 columns</p>
</div>

<h1 id="ëœë¤-í¬ë ˆìŠ¤íŠ¸">ëœë¤ í¬ë ˆìŠ¤íŠ¸</h1>
<p>ëœë¤ í¬ë ˆìŠ¤íŠ¸ì˜ ê°€ì¥ í•µì‹¬ì ì¸ íŠ¹ì§•ì€ ì„ì˜ì„±(randomness)ì— ì˜í•´ ì„œë¡œ ì¡°ê¸ˆì”© ë‹¤ë¥¸ íŠ¹ì„±ì„ ê°–ëŠ” íŠ¸ë¦¬ë“¤ë¡œ êµ¬ì„±ëœë‹¤ëŠ” ì ì´ë‹¤. ì´ íŠ¹ì§•ì€ ê° íŠ¸ë¦¬ë“¤ì˜ ì˜ˆì¸¡(prediction)ë“¤ì´ ë¹„ìƒê´€í™”(decorrelation) ë˜ê²Œí•˜ë©°, ê²°ê³¼ì ìœ¼ë¡œ ì¼ë°˜í™”(generalization) ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¨ë‹¤. ë˜í•œ, ì„ì˜í™”(randomization)ëŠ” í¬ë ˆìŠ¤íŠ¸ê°€ ë…¸ì´ì¦ˆê°€ í¬í•¨ëœ ë°ì´í„°ì— ëŒ€í•´ì„œë„ ê°•í•˜ê²Œ ë§Œë“¤ì–´ ì¤€ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1"># ëœë¤í¬ë ˆìŠ¤íŠ¸ ë¶„ë¥˜ê¸°ë¥¼ ì‚¬ìš©
</span><span class="n">forest</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span>
    <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2018</span><span class="p">)</span>
<span class="n">forest</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,
                       criterion='gini', max_depth=None, max_features='auto',
                       max_leaf_nodes=None, max_samples=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=100,
                       n_jobs=-1, oob_score=False, random_state=2018, verbose=0,
                       warm_start=False)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">time</span> <span class="n">forest</span> <span class="o">=</span> <span class="n">forest</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_features</span><span class="p">,</span> <span class="n">train</span><span class="p">[</span><span class="s">'sentiment'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 1min 25s, sys: 164 ms, total: 1min 25s
Wall time: 44 s
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="o">%</span><span class="n">time</span> <span class="n">score</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span>\
    <span class="n">forest</span><span class="p">,</span> <span class="n">train_data_features</span><span class="p">,</span> \
    <span class="n">train</span><span class="p">[</span><span class="s">'sentiment'</span><span class="p">],</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'roc_auc'</span><span class="p">))</span>
<span class="n">score</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 13.6 s, sys: 1.54 s, total: 15.2 s
Wall time: 6min 26s





0.92761104
</code></pre></div></div>

<h1 id="ì˜ˆì¸¡">ì˜ˆì¸¡</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ìœ„ì—ì„œ ì •ì œí•´ì¤€ ë¦¬ë·°ì˜ ì²« ë²ˆì§¸ ë°ì´í„°ë¥¼ í™•ì¸
</span><span class="n">clean_test_reviews</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'natur film main theme mortal nostalgia loss innoc perhap surpris rate high older viewer younger one howev craftsmanship complet film anyon enjoy pace steadi constant charact full engag relationship interact natur show need flood tear show emot scream show fear shout show disput violenc show anger natur joyc short stori lend film readi made structur perfect polish diamond small chang huston make inclus poem fit neat truli masterpiec tact subtleti overwhelm beauti'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë²¡í„°í™” í•¨
</span><span class="o">%</span><span class="n">time</span> <span class="n">test_data_features</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">clean_test_reviews</span><span class="p">)</span>
<span class="n">test_data_features</span> <span class="o">=</span> <span class="n">test_data_features</span><span class="p">.</span><span class="n">toarray</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CPU times: user 8.12 s, sys: 68.9 ms, total: 8.19 s
Wall time: 8.2 s
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_data_features</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       ...,
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0],
       [0, 0, 0, ..., 0, 0, 0]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë²¡í„°í™” ëœ ë‹¨ì–´ë¡œ ìˆ«ìê°€ ë¬¸ì„œì—ì„œ ë“±ì¥í•˜ëŠ” íšŸìˆ˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤
</span><span class="n">test_data_features</span><span class="p">[</span><span class="mi">5</span><span class="p">][:</span><span class="mi">100</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë²¡í„°í™” í•˜ë©° ë§Œë“  ì‚¬ì „ì—ì„œ í•´ë‹¹ ë‹¨ì–´ê°€ ë¬´ì—‡ì¸ì§€ ì°¾ì•„ë³¼ ìˆ˜ ìˆë‹¤.
# vocab = vectorizer.get_feature_names()
</span><span class="n">vocab</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">vocab</span><span class="p">[</span><span class="mi">2558</span><span class="p">],</span> <span class="n">vocab</span><span class="p">[</span><span class="mi">2559</span><span class="p">],</span> <span class="n">vocab</span><span class="p">[</span><span class="mi">2560</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>('abc', 'charact person', 'charact play', 'charact plot')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">forest</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_features</span><span class="p">)</span>
<span class="n">result</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([1, 0, 0, 1, 1, 1, 0, 1, 0, 0])
</code></pre></div></div>

<h1 id="ìºê¸€-ì œì¶œì„-ìœ„í•´-ì˜ˆì¸¡ê²°ê³¼-ì €ì¥">ìºê¸€ ì œì¶œì„ ìœ„í•´ ì˜ˆì¸¡ê²°ê³¼ ì €ì¥</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ë°ì´í„°í”„ë ˆì„ì— ë‹´ì•„ ì¤€ë‹¤.
</span><span class="n">output</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">'id'</span><span class="p">:</span><span class="n">test</span><span class="p">[</span><span class="s">'id'</span><span class="p">],</span> <span class="s">'sentiment'</span><span class="p">:</span><span class="n">result</span><span class="p">})</span>
<span class="n">output</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>"12311_10"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>"8348_2"</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>"5828_4"</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"7186_2"</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>"12128_7"</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">output</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'/content/drive/MyDrive/kaggle/data/tutorial_1_BOW_{0:.5f}.csv'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">score</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">output_sentiment</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="s">'sentiment'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">output_sentiment</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">output_sentiment</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">output_sentiment</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>108





0    12554
1    12446
Name: sentiment, dtype: int64
</code></pre></div></div>

<h1 id="train-testì˜-ê°ì •ë¶„ë¥˜-ê²°ê³¼-ê°’-ë¹„êµ">Train, Testì˜ ê°ì •ë¶„ë¥˜ ê²°ê³¼ ê°’ ë¹„êµ</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'sentiment'</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="s">'sentiment'</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
/usr/local/lib/python3.7/dist-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning





&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f8dc895f2d0&gt;
</code></pre></div></div>

<p><img src="../../img/kaggle/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn/output_73_2.png" alt="output_73_2" /></p>

<h1 id="ìºê¸€-ì œì¶œ-ê²°ê³¼">ìºê¸€ ì œì¶œ ê²°ê³¼</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># íŒŒë¼ë©”í„°ë¥¼ ì¡°ì •í•´ ê°€ë©° ì ìˆ˜ë¥¼ ì¡°ê¸ˆì”© ì˜¬ë ¤ë³¸ë‹¤.
</span>
<span class="c1"># uni-gram ì‚¬ìš© ì‹œ ìºê¸€ ì ìˆ˜ 0.84476
</span><span class="k">print</span><span class="p">(</span><span class="mi">436</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
<span class="c1"># tri-gram ì‚¬ìš© ì‹œ ìºê¸€ ì ìˆ˜ 0.84608
</span><span class="k">print</span><span class="p">(</span><span class="mi">388</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
<span class="c1"># ì–´ê°„ì¶”ì¶œ í›„ ìºê¸€ ì ìˆ˜ 0.84780
</span><span class="k">print</span><span class="p">(</span><span class="mi">339</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
<span class="c1"># ëœë¤í¬ë ˆìŠ¤íŠ¸ì˜ max_depth = 5 ë¡œ ì§€ì •í•˜ê³ 
# CountVectorizerì˜ tokenizer=nltk.word_tokenize ë¥¼ ì§€ì • í›„ ìºê¸€ ì ìˆ˜ 0.81460
</span><span class="k">print</span><span class="p">(</span><span class="mi">546</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
<span class="c1"># ëœë¤í¬ë ˆìŠ¤íŠ¸ì˜ max_depth = 5 ëŠ” ë‹¤ì‹œ Noneìœ¼ë¡œ ë³€ê²½
# CountVectorizer max_features = 10000ê°œë¡œ ë³€ê²½ í›„ ìºê¸€ ì ìˆ˜ 0.85272
</span><span class="k">print</span><span class="p">(</span><span class="mi">321</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
<span class="c1"># CountVectorizerì˜ tokenizer=nltk.word_tokenize ë¥¼ ì§€ì • í›„ ìºê¸€ ì ìˆ˜ 0.85044
</span><span class="k">print</span><span class="p">(</span><span class="mi">326</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
<span class="c1"># CountVectorizer max_features = 10000ê°œë¡œ ë³€ê²½ í›„ ìºê¸€ ì ìˆ˜ 0.85612
</span><span class="k">print</span><span class="p">(</span><span class="mi">305</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
<span class="c1"># 0.85884
</span><span class="k">print</span><span class="p">(</span><span class="mi">296</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="mi">310</span><span class="o">/</span><span class="mi">578</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.754325259515571
0.671280276816609
0.5865051903114187
0.9446366782006921
0.5553633217993079
0.5640138408304498
0.527681660899654
0.5121107266435986
0.5363321799307958
</code></pre></div></div>

<h1 id="labeledtraindatatsv-testdatatsv-unlabeledtraindatatsv-ë°ì´í„°ë¥¼-ë°‘ì—-ë§í¬ë¥¼-í´ë¦­í•˜ë©´-ë‹¤ìš´ë¡œë“œ-ê°€ëŠ¥í•©ë‹ˆë‹¤-íŒŒì¼ì´-í¬ë‹¤ë³´ë‹ˆ-ê¹ƒí—ˆë¸Œì—-ì˜¬ë ¤ì§€ì§€-ì•Šì•„-êµ¬ê¸€-ë“œë¼ì´ë¸Œ-ë§í¬-ê³µìœ í•©ë‹ˆë‹¤">labeledTrainData.tsv, testData.tsv, unlabeledTrainData.tsv ë°ì´í„°ë¥¼ ë°‘ì— ë§í¬ë¥¼ í´ë¦­í•˜ë©´ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤. íŒŒì¼ì´ í¬ë‹¤ë³´ë‹ˆ ê¹ƒí—ˆë¸Œì— ì˜¬ë ¤ì§€ì§€ ì•Šì•„ êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë§í¬ ê³µìœ í•©ë‹ˆë‹¤</h1>

<p><a href="https://drive.google.com/drive/folders/1eVFhPNhAKnJLaruEh87XJ1P8nBKLhMGG?usp=sharing">https://drive.google.com/drive/folders/1eVFhPNhAKnJLaruEh87XJ1P8nBKLhMGG?usp=sharing</a></p>


            </section>

        </article>

    </div>
</main>

<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->
<script>
$(function() {
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
});
</script>



        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://SEONGJAE-YOO.github.io/">Big Data</a> &copy; 2021</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://seongjae-yoo.github.io/" target="_blank" rel="noopener">SeongJae Yu ë¸”ë¡œê·¸</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            
            <h1 class="subscribe-overlay-title">Search Big Data</h1>
            <p class="subscribe-overlay-description">
                ì›í•˜ëŠ” ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()"
               id="searchtext" type="text" name="searchtext"
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
        </div>
    </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
